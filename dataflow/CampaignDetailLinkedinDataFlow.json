{
	"name": "CampaignDetailLinkedinDataFlow",
	"properties": {
		"folder": {
			"name": "Linkedin"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CampaignDetailLinkedinStage",
						"type": "DatasetReference"
					},
					"name": "CampaignDetailLinkedinStage"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CampaignDetailLinkedin",
						"type": "DatasetReference"
					},
					"name": "CampaignDetailLinkedin"
				}
			],
			"transformations": [
				{
					"name": "PrepareColumns"
				}
			],
			"script": "source(output(\n\t\tCampaignId as string,\n\t\tCampaignDateDay as integer,\n\t\tCampaignDateMonth as integer,\n\t\tCampaignDateYear as integer,\n\t\tCampaignEndDay as integer,\n\t\tCampaignEndMonth as integer,\n\t\tCampaignEndYear as integer,\n\t\tTotalSpent as integer,\n\t\tactionClicks as integer,\n\t\tadUnitClicks as integer,\n\t\tapproximateUniqueImpressions as integer,\n\t\tcardClicks as integer,\n\t\tcardImpressions as integer,\n\t\tclicks as integer,\n\t\tcommentLikes as integer,\n\t\tcomments as integer,\n\t\tcompanyPageClicks as integer,\n\t\tconversionValueInLocalCurrency as integer,\n\t\tcostInLocalCurrency as string,\n\t\tcostInUsd as string,\n\t\texternalWebsiteConversions as integer,\n\t\texternalWebsitePostClickConversions as integer,\n\t\texternalWebsitePostViewConversions as integer,\n\t\tfollows as integer,\n\t\tfullScreenPlays as integer,\n\t\timpressions as integer,\n\t\tlandingPageClicks as integer,\n\t\tleadGenerationMailContactInfoShares as integer,\n\t\tleadGenerationMailInterestedClicks as integer,\n\t\tlikes as integer,\n\t\toneClickLeadFormOpens as integer,\n\t\toneClickLeads as integer,\n\t\topens as integer,\n\t\totherEngagements as integer,\n\t\treturnOnAreactionsdSpend as integer,\n\t\tsends as integer,\n\t\tshares as integer,\n\t\ttextUrlClicks as integer,\n\t\ttotalEngagements as integer,\n\t\tvideoCompletions as integer,\n\t\tvideoFirstQuartileCompletions as integer,\n\t\tvideoMidpointCompletions as integer,\n\t\tvideoStarts as integer,\n\t\tvideoThirdQuartileCompletions as integer,\n\t\tvideoViews as integer,\n\t\tviralCardClicks as integer,\n\t\tviralCardImpressions as integer,\n\t\tviralClicks as integer,\n\t\tviralCommentLikes as integer,\n\t\tviralComments as integer,\n\t\tviralCompanyPageClicks as integer,\n\t\tviralExternalWebsiteConversions as integer,\n\t\tviralExternalWebsitePostClickConversions as integer,\n\t\tviralExternalWebsitePostViewConversions as integer,\n\t\tviralFollows as integer,\n\t\tviralFullScreenPlays as integer,\n\t\tviralImpressions as integer,\n\t\tviralLandingPageClicks as integer,\n\t\tviralLikes as integer,\n\t\tviralOneClickLeadFormOpens as integer,\n\t\tviralOneClickLeads as integer,\n\t\tviralOtherEngagements as integer,\n\t\tviralReactions as integer,\n\t\tviralShares as integer,\n\t\tviralTotalEngagements as integer,\n\t\tviralVideoCompletions as integer,\n\t\tviralVideoFirstQuartileCompletions as integer,\n\t\tviralVideoMidpointCompletions as integer,\n\t\tviralVideoStarts as integer,\n\t\tviralVideoThirdQuartileCompletions as integer,\n\t\tviralVideoViews as integer,\n\t\treactions as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> CampaignDetailLinkedinStage\nCampaignDetailLinkedinStage derive(CampaignId = replace(replace(CampaignId, '[\"urn:li:sponsoredCampaign:',''),'\"]',''),\n\t\tCampaignStartDate = toDate(toString(CampaignDateYear) + '-' + toString(CampaignDateMonth) +  '-'+ toString(CampaignDateDay) , 'yyyy-MM-dd'),\n\t\tCampaignEndDate = toDate(toString(CampaignEndYear) + '-' + toString(CampaignEndMonth) +  '-'+ toString(CampaignEndDay) , 'yyyy-MM-dd')) ~> PrepareColumns\nPrepareColumns sink(input(\n\t\tCampaignId as integer,\n\t\tCampaignStartDate as timestamp,\n\t\tCampaignEndDate as timestamp,\n\t\tTotalSpent as integer,\n\t\tactionClicks as integer,\n\t\tadUnitClicks as integer,\n\t\tapproximateUniqueImpressions as integer,\n\t\tcardClicks as integer,\n\t\tcardImpressions as integer,\n\t\tclicks as integer,\n\t\tcommentLikes as integer,\n\t\tcomments as integer,\n\t\tcompanyPageClicks as integer,\n\t\tconversionValueInLocalCurrency as integer,\n\t\tcostInLocalCurrency as string,\n\t\tcostInUsd as string,\n\t\texternalWebsiteConversions as integer,\n\t\texternalWebsitePostClickConversions as integer,\n\t\texternalWebsitePostViewConversions as integer,\n\t\tfollows as integer,\n\t\tfullScreenPlays as integer,\n\t\timpressions as integer,\n\t\tlandingPageClicks as integer,\n\t\tleadGenerationMailContactInfoShares as integer,\n\t\tleadGenerationMailInterestedClicks as integer,\n\t\tlikes as integer,\n\t\toneClickLeadFormOpens as integer,\n\t\toneClickLeads as integer,\n\t\topens as integer,\n\t\totherEngagements as integer,\n\t\treturnOnAreactionsdSpend as integer,\n\t\tsends as integer,\n\t\tshares as integer,\n\t\ttextUrlClicks as integer,\n\t\ttotalEngagements as integer,\n\t\tvideoCompletions as integer,\n\t\tvideoFirstQuartileCompletions as integer,\n\t\tvideoMidpointCompletions as integer,\n\t\tvideoStarts as integer,\n\t\tvideoThirdQuartileCompletions as integer,\n\t\tvideoViews as integer,\n\t\tviralCardClicks as integer,\n\t\tviralCardImpressions as integer,\n\t\tviralClicks as integer,\n\t\tviralCommentLikes as integer,\n\t\tviralComments as integer,\n\t\tviralCompanyPageClicks as integer,\n\t\tviralExternalWebsiteConversions as integer,\n\t\tviralExternalWebsitePostClickConversions as integer,\n\t\tviralExternalWebsitePostViewConversions as integer,\n\t\tviralFollows as integer,\n\t\tviralFullScreenPlays as integer,\n\t\tviralImpressions as integer,\n\t\tviralLandingPageClicks as integer,\n\t\tviralLikes as integer,\n\t\tviralOneClickLeadFormOpens as integer,\n\t\tviralOneClickLeads as integer,\n\t\tviralOtherEngagements as integer,\n\t\tviralReactions as integer,\n\t\tviralShares as integer,\n\t\tviralTotalEngagements as integer,\n\t\tviralVideoCompletions as integer,\n\t\tviralVideoFirstQuartileCompletions as integer,\n\t\tviralVideoMidpointCompletions as integer,\n\t\tviralVideoStarts as integer,\n\t\tviralVideoThirdQuartileCompletions as integer,\n\t\tviralVideoViews as integer,\n\t\treactions as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tCampaignId,\n\t\tCampaignStartDate,\n\t\tCampaignEndDate,\n\t\tTotalSpent,\n\t\tactionClicks,\n\t\tadUnitClicks,\n\t\tapproximateUniqueImpressions,\n\t\tcardClicks,\n\t\tcardImpressions,\n\t\tclicks,\n\t\tcommentLikes,\n\t\tcomments,\n\t\tcompanyPageClicks,\n\t\tconversionValueInLocalCurrency,\n\t\tcostInLocalCurrency,\n\t\tcostInUsd,\n\t\texternalWebsiteConversions,\n\t\texternalWebsitePostClickConversions,\n\t\texternalWebsitePostViewConversions,\n\t\tfollows,\n\t\tfullScreenPlays,\n\t\timpressions,\n\t\tlandingPageClicks,\n\t\tleadGenerationMailContactInfoShares,\n\t\tleadGenerationMailInterestedClicks,\n\t\tlikes,\n\t\toneClickLeadFormOpens,\n\t\toneClickLeads,\n\t\topens,\n\t\totherEngagements,\n\t\treturnOnAreactionsdSpend,\n\t\tsends,\n\t\tshares,\n\t\ttextUrlClicks,\n\t\ttotalEngagements,\n\t\tvideoCompletions,\n\t\tvideoFirstQuartileCompletions,\n\t\tvideoMidpointCompletions,\n\t\tvideoStarts,\n\t\tvideoThirdQuartileCompletions,\n\t\tvideoViews,\n\t\tviralCardClicks,\n\t\tviralCardImpressions,\n\t\tviralClicks,\n\t\tviralCommentLikes,\n\t\tviralComments,\n\t\tviralCompanyPageClicks,\n\t\tviralExternalWebsiteConversions,\n\t\tviralExternalWebsitePostClickConversions,\n\t\tviralExternalWebsitePostViewConversions,\n\t\tviralFollows,\n\t\tviralFullScreenPlays,\n\t\tviralImpressions,\n\t\tviralLandingPageClicks,\n\t\tviralLikes,\n\t\tviralOneClickLeadFormOpens,\n\t\tviralOneClickLeads,\n\t\tviralOtherEngagements,\n\t\tviralReactions,\n\t\tviralShares,\n\t\tviralTotalEngagements,\n\t\tviralVideoCompletions,\n\t\tviralVideoFirstQuartileCompletions,\n\t\tviralVideoMidpointCompletions,\n\t\tviralVideoStarts,\n\t\tviralVideoThirdQuartileCompletions,\n\t\tviralVideoViews,\n\t\treactions\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> CampaignDetailLinkedin"
		}
	}
}