{
	"name": "ContactsDataFlow",
	"properties": {
		"folder": {
			"name": "Hubspot"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "HubspotContactStage",
						"type": "DatasetReference"
					},
					"name": "HubspotContactStage"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "HubspotContact",
						"type": "DatasetReference"
					},
					"name": "HubspotContact"
				}
			],
			"transformations": [
				{
					"name": "PrepareColumns"
				}
			],
			"script": "source(output(\n\t\ths_object_id as string,\n\t\tchannel as string,\n\t\tacquistion_date_from_import as string,\n\t\trecent_deal_close_date as string,\n\t\ths_lifecyclestage_marketingqualifiedlead_date as string,\n\t\tclosedate as string,\n\t\tnum_associated_deals as string,\n\t\trecent_deal_amount as string,\n\t\tnum_contacted_notes as string,\n\t\tnum_notes as string,\n\t\tdate_of_birth as string,\n\t\ths_analytics_source as string,\n\t\tlead_is_probably_relevant_for_dfo as string,\n\t\tdetailed_source as string,\n\t\ths_lifecyclestage_salesqualifiedlead_date as string,\n\t\tassigned_rm as string,\n\t\tassigned_to as string,\n\t\tmeeting_booked as string,\n\t\twork_email as string,\n\t\tquestions_embed_url_utm_medium as string,\n\t\tactive_sal_or_not as string,\n\t\ths_lifecyclestage_opportunity_date as string,\n\t\ths_analytics_source_data_1 as string,\n\t\tbrighttalk_webcast_title as string,\n\t\ths_analytics_source_data_2 as string,\n\t\tlifecyclestage as string,\n\t\tquestions_embed_url_utm_source as string,\n\t\tis_this_lead_already_found_in_an_internal_database as string,\n\t\tcountry as string,\n\t\ths_persona as string,\n\t\ths_lifecyclestage_customer_date as string,\n\t\tsource_of_sign_up as string,\n\t\twebcast_activity as string,\n\t\tdays_to_close as string,\n\t\tage_range as string,\n\t\tip_country as string,\n\t\tage as string,\n\t\tupdated as string,\n\t\tcreated as string,\n\t\thasMore as string,\n\t\tVidOffset as string,\n\t\tInsertedDate as timestamp,\n\t\tcontact_type as string,\n\t\ths_analytics_first_url as string,\n\t\tgender as string,\n\t\ton24utm as string,\n\t\tfirstname as string,\n\t\tlastname as string,\n\t\tmobilephone as string,\n\t\tphone as string,\n\t\tfax as string,\n\t\taddress_line_1 as string,\n\t\taddress_line_2 as string,\n\t\tcity as string,\n\t\tstate as string,\n\t\thubspot_owner_id as string,\n\t\tlifecycle_stage_status as string,\n\t\t{time-offset} as long,\n\t\trecent_conversion_event_name as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> HubspotContactStage\nHubspotContactStage derive(acquistion_date_from_import = toTimestamp(toLong(acquistion_date_from_import),'yyyy-MM-dd HH:mm:ss'),\n\t\ths_lifecyclestage_marketingqualifiedlead_date = toTimestamp(toLong(hs_lifecyclestage_marketingqualifiedlead_date),'yyyy-MM-dd HH:mm:ss'),\n\t\ths_lifecyclestage_salesqualifiedlead_date = toTimestamp(toLong(hs_lifecyclestage_salesqualifiedlead_date),'yyyy-MM-dd HH:mm:ss'),\n\t\ths_lifecyclestage_opportunity_date = toTimestamp(toLong(hs_lifecyclestage_opportunity_date),'yyyy-MM-dd HH:mm:ss'),\n\t\ths_lifecyclestage_customer_date = toTimestamp(toLong(hs_lifecyclestage_customer_date),'yyyy-MM-dd HH:mm:ss'),\n\t\tcreated = toTimestamp(toLong(created),'yyyy-MM-dd HH:mm:ss'),\n\t\tupdated = toTimestamp(toLong(updated),'yyyy-MM-dd HH:mm:ss'),\n\t\tclosedate = toTimestamp(toLong(closedate),'yyyy-MM-dd HH:mm:ss'),\n\t\trecent_deal_close_date = toTimestamp(toLong(recent_deal_close_date),'yyyy-MM-dd HH:mm:ss')) ~> PrepareColumns\nPrepareColumns sink(input(\n\t\tContactId as integer,\n\t\tFirstName as string,\n\t\tLastName as string,\n\t\tAddressLine1 as string,\n\t\tAddressLine2 as string,\n\t\tCity as string,\n\t\tState as string,\n\t\tCountry as string,\n\t\tMobilePhone as string,\n\t\tPhone as string,\n\t\tFax as string,\n\t\tDateOfBirth as string,\n\t\tContactType as string,\n\t\tAge as string,\n\t\tAgeRange as string,\n\t\tGender as string,\n\t\tChannel as string,\n\t\tHubspotOwnerId as long,\n\t\tAcquistionDateFromImport as timestamp,\n\t\tRecentDealCloseDate as timestamp,\n\t\tBecameMarketingQualifiedLeadDate as timestamp,\n\t\tCloseDate as timestamp,\n\t\tAssociatedDeals as integer,\n\t\tRecentDealAmount as decimal(18,0),\n\t\tNumberOfTimesContacted as string,\n\t\tNumberOfSalesActivities as string,\n\t\tOriginalSource as string,\n\t\tLeadsProbablyRelevantForDFOAndARMShouldTalkToHimFirstAssessmentOfLeadStatus as string,\n\t\tDetailedSource as string,\n\t\tBecameASalesQualifiedLeadDate as timestamp,\n\t\tAssignedRm as string,\n\t\tAssignedTo as string,\n\t\tMeetingBooked as string,\n\t\tWorkEmail as string,\n\t\tEmbedUrlUtmMedium as string,\n\t\tActiveSalOrNot as string,\n\t\tBecameAnOpportunityDate as timestamp,\n\t\tOriginalSourceDrillDown1 as string,\n\t\tBrighttalkWebcastTitle as string,\n\t\tOriginalSourceDrillDown2 as string,\n\t\tLifecycleStage as string,\n\t\tEmbedUrlUtmSource as string,\n\t\tIsThisLeadAlreadyFoundInInternalDatabase as string,\n\t\tPersona as string,\n\t\tBecameACustomerDate as timestamp,\n\t\tSourceOfSignUp as string,\n\t\tWebcastActivity as string,\n\t\tDaysToClose as string,\n\t\tIPCountry as string,\n\t\tupdated as timestamp,\n\t\tcreated as timestamp,\n\t\tFirstPageSeen as string,\n\t\tOn24UTM as string,\n\t\tDFOLifeCycleStage as string,\n\t\tRecentConversion as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tContactId = hs_object_id,\n\t\tChannel = channel,\n\t\tAcquistionDateFromImport = acquistion_date_from_import,\n\t\tRecentDealCloseDate = recent_deal_close_date,\n\t\tBecameMarketingQualifiedLeadDate = hs_lifecyclestage_marketingqualifiedlead_date,\n\t\tCloseDate = closedate,\n\t\tAssociatedDeals = num_associated_deals,\n\t\tRecentDealAmount = recent_deal_amount,\n\t\tNumberOfTimesContacted = num_contacted_notes,\n\t\tNumberOfSalesActivities = num_notes,\n\t\tDateOfBirth = date_of_birth,\n\t\tOriginalSource = hs_analytics_source,\n\t\tLeadsProbablyRelevantForDFOAndARMShouldTalkToHimFirstAssessmentOfLeadStatus = lead_is_probably_relevant_for_dfo,\n\t\tDetailedSource = detailed_source,\n\t\tBecameASalesQualifiedLeadDate = hs_lifecyclestage_salesqualifiedlead_date,\n\t\tAssignedRm = assigned_rm,\n\t\tAssignedTo = assigned_to,\n\t\tMeetingBooked = meeting_booked,\n\t\tWorkEmail = work_email,\n\t\tEmbedUrlUtmMedium = questions_embed_url_utm_medium,\n\t\tActiveSalOrNot = active_sal_or_not,\n\t\tBecameAnOpportunityDate = hs_lifecyclestage_opportunity_date,\n\t\tOriginalSourceDrillDown1 = hs_analytics_source_data_1,\n\t\tBrighttalkWebcastTitle = brighttalk_webcast_title,\n\t\tOriginalSourceDrillDown2 = hs_analytics_source_data_2,\n\t\tLifecycleStage = lifecyclestage,\n\t\tEmbedUrlUtmSource = questions_embed_url_utm_source,\n\t\tIsThisLeadAlreadyFoundInInternalDatabase = is_this_lead_already_found_in_an_internal_database,\n\t\tCountry = country,\n\t\tPersona = hs_persona,\n\t\tBecameACustomerDate = hs_lifecyclestage_customer_date,\n\t\tSourceOfSignUp = source_of_sign_up,\n\t\tWebcastActivity = webcast_activity,\n\t\tDaysToClose = days_to_close,\n\t\tAgeRange = age_range,\n\t\tIPCountry = ip_country,\n\t\tAge = age,\n\t\tupdated,\n\t\tcreated,\n\t\tContactType = contact_type,\n\t\tFirstPageSeen = hs_analytics_first_url,\n\t\tGender = gender,\n\t\tOn24UTM = on24utm,\n\t\tFirstName = firstname,\n\t\tLastName = lastname,\n\t\tMobilePhone = mobilephone,\n\t\tPhone = phone,\n\t\tFax = fax,\n\t\tAddressLine1 = address_line_1,\n\t\tAddressLine2 = address_line_2,\n\t\tCity = city,\n\t\tHubspotOwnerId = hubspot_owner_id,\n\t\tState = state,\n\t\tDFOLifeCycleStage = lifecycle_stage_status,\n\t\tRecentConversion = recent_conversion_event_name\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> HubspotContact"
		}
	}
}